	<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.19" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  
  <title>Mac下批量下载迅雷离线文件-AppleScript &middot; sycx blog</title>
  

  
  <link rel="stylesheet" href="http://blog.sycx.me/css/poole.css">
  <link rel="stylesheet" href="http://blog.sycx.me/css/syntax.css">
  <link rel="stylesheet" href="http://blog.sycx.me/css/hyde.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  <link href="" rel="alternate" type="application/rss+xml" title="sycx blog" />

  
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-19868922-3', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>

</head>

	<body class="theme-base-0c layout-reverse">
		<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="http://blog.sycx.me/"><h1>sycx blog</h1></a>
      <p class="lead">
       碎月有把杀猪刀 
      </p>
    </div>

    <ul class="sidebar-nav">
      <li><a href="/">Home</a> </li>
      
    </ul>

    <p>&copy; 2017. All rights reserved. </p>
  </div>
</div>


		<div class="content container">
			<div class="post">
			 	<h1>Mac下批量下载迅雷离线文件-AppleScript</h1>
			  <span class="post-date">Thu, Apr 7, 2011</span>
			      

<h2 id="update">[Update]</h2>

<h3 id="2011年6月3日">2011年6月3日：</h3>

<p>添加了反序功能（默认开启），对非BT类批量下载链接进行倒序，功能开关请直接改代码。</p>

<p>代码整理，并增加了一些注释。</p>

<p>下载：<a href="http://blog.sycx.me/uploads/2011/04/ThunderLixian-110603.zip">ThunderLixian-110603</a></p>

<h3 id="2011年4月28日">2011年4月28日：</h3>

<p>给AppleScript方法添加了BT类任务支持</p>

<p>新代码请自行打开Service查看，懒得贴上来了..</p>

<p>新Service下载：<a href="http://blog.sycx.me/uploads/2011/04/ThunderLixian-BTSupport.zip">ThunderLixian-BTSupport</a></p>

<p>用法：对BT任务点击 &ldquo;显示BT列表&rdquo;，之后勾选要下载的文件，然后运行Service。</p>

<h2 id="new-bookmarklet">[NEW]Bookmarklet:</h2>

<p>研究了下JavaScript，现学现卖，于是有了个更通用的解决方案</p>

<h3 id="添加书签">添加书签：</h3>

<p><a style="text-decoration: none; background: #f4f4f4; border-radius: 5px; color: #666; border: 1px solid #999; padding: 5px; cursor: move;" href="javascript:(function(){cA=document.getElementsByClassName('con')[0];hA=document.getElementById('hackArea');if(hA){cA.removeChild(hA);}hA=document.createElement('div');hA.id='hackArea';sO=document.getElementsByName('ck');sV=sO.length;for(i=0;i&lt;sV;i++){if(sO[i].checked==true){tI=sO[i].value;lI='dl_url'+tI.toString();nI='durl'+tI.toString();oL=document.getElementById(lI).value;lN=document.getElementById(nI).value;link=document.createElement('A');link.href=oL;link.innerHTML=lN;hA.appendChild(link);hA.appendChild(document.createElement('br'));}}cA.appendChild(hA);})()">迅雷批量</a></p>

<p>将上方按钮拖到书签栏</p>

<p><a href="http://blog.sycx.me/uploads/2011/04/ThunderLixianBookmark1.png"><img class="alignnone size-full wp-image-191" title="ThunderLixianBookmark1" src="http://blog.sycx.me/uploads/2011/04/ThunderLixianBookmark1.png" alt="" width="329" height="369" /></a></p>

<h3 id="用法">用法：</h3>

<p>如图：</p>

<p><a href="http://blog.sycx.me/uploads/2011/04/ThunderLixianBookmark2.png"><img class="alignnone size-full wp-image-192" title="ThunderLixianBookmark2" src="http://blog.sycx.me/uploads/2011/04/ThunderLixianBookmark2.png" alt="" width="358" height="598" /></a></p>

<h3 id="已知限制">已知限制：</h3>

<p><ol>
    <li>Safari和Chrome测试可用，但是Firefox3.6无效，原因不知。</li>
    <li>依然不支持BT类任务，哪天我有下到BT资源可能会解决。</li>
</ol></p>

<h2 id="old-applescript">[Old]AppleScript:</h2>

<h3 id="创建">创建：</h3>

<p>打开Automator,创建一个Service
拖放一个Action &ldquo;Run AppleScript&rdquo;
复制下方代码进去，保存。
如图：
<a href="http://blog.sycx.me/uploads/2011/04/ThunderLixianSample.png"><img class="alignnone size-full wp-image-181" title="ThunderLixianSample" src="http://blog.sycx.me/uploads/2011/04/ThunderLixianSample.png" alt="" width="607" height="707" /></a></p>

<p>或者直接下载文件：<a href="http://blog.sycx.me/uploads/2011/04/ThunderLixian.workflow.zip">ThunderLixian.workflow</a> 解压放到 ~/Library/Services/</p>

<h3 id="使用">使用：</h3>

<p>用Safari打开迅雷离线网页,勾选你要下载的文件，然后运行Service
<a href="http://blog.sycx.me/uploads/2011/04/ThunderLixianSample2.png"><img class="alignnone size-full wp-image-183" title="ThunderLixianSample2" src="http://blog.sycx.me/uploads/2011/04/ThunderLixianSample2.png" alt="" width="524" height="329" /></a></p>

<p>如此，便会自动调用iGetter批量下载了。</p>

<h3 id="局限">局限：</h3>

<p>这个Service是随便写来自用的，只达到刚好够用的标准，所以很有局限性：
<ol>
    <li>所勾选的文件请必须是已下载完成的，而且不支持BT类文件</li>
    <li>调用iGetter下载，要用其它下载工具得自己改代码哦～</li>
    <li>只支持Safari</li>
</ol></p>

<h3 id="初版代码">初版代码：</h3>
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span><span style="color: #008800; font-weight: bold">tell</span> <span style="color: #007020">application</span> <span style="background-color: #fff0f0">&quot;Safari&quot;</span>
	<span style="color: #008800; font-weight: bold">if</span> (<span style="color: #007020">exists</span> <span style="color: #0000CC">document</span> <span style="background-color: #fff0f0">&quot;迅雷会员-离线下载&quot;</span>) <span style="color: #008800; font-weight: bold">then</span>
		<span style="color: #008800; font-weight: bold">set</span> <span style="color: #996633">doc</span> <span style="color: #008800; font-weight: bold">to</span> <span style="color: #0000CC">document</span> <span style="background-color: #fff0f0">&quot;迅雷会员-离线下载&quot;</span>
		<span style="color: #008800; font-weight: bold">set</span> <span style="color: #996633">src</span> <span style="color: #008800; font-weight: bold">to</span> <span style="background-color: #fff0f0">&quot;var syO = document.getElementsByName(&#39;ck&#39;);</span>
<span style="background-color: #fff0f0">var syVal = syO.length;</span>
<span style="background-color: #fff0f0">var syList=[];</span>
<span style="background-color: #fff0f0">for(var i=0; i&lt; syVal;i++){</span>
<span style="background-color: #fff0f0">    if(syO[i].checked == true){</span>
<span style="background-color: #fff0f0">    var taskid = syO[i].value;</span>
<span style="background-color: #fff0f0">    var linkId = &#39;dl_url&#39;+taskid.toString();</span>
<span style="background-color: #fff0f0">    var oneLink = document.getElementById(linkId).value;</span>
<span style="background-color: #fff0f0">    syList.push(oneLink);</span>
<span style="background-color: #fff0f0">    }}</span>
<span style="background-color: #fff0f0">syList;&quot;</span>
		<span style="color: #008800; font-weight: bold">set</span> <span style="color: #996633">downList</span> <span style="color: #008800; font-weight: bold">to</span> <span style="color: #996633">do</span> <span style="color: #996633">JavaScript</span> <span style="color: #996633">src</span> <span style="color: #008800; font-weight: bold">in</span> <span style="color: #996633">doc</span>

		<span style="color: #008800; font-weight: bold">tell</span> <span style="color: #007020">application</span> <span style="background-color: #fff0f0">&quot;iGetter&quot;</span>
			<span style="color: #008800; font-weight: bold">set</span> <span style="color: #996633">newDownList</span> <span style="color: #008800; font-weight: bold">to</span> {}
			<span style="color: #008800; font-weight: bold">repeat</span> <span style="color: #996633">with</span> <span style="color: #996633">i</span> <span style="color: #008800; font-weight: bold">from</span> <span style="color: #0000DD; font-weight: bold">1</span> <span style="color: #008800; font-weight: bold">to</span> <span style="color: #996633">number</span> <span style="color: #008800; font-weight: bold">of</span> <span style="color: #007020">items</span> <span style="color: #008800; font-weight: bold">in</span> <span style="color: #996633">downList</span>
				<span style="color: #008800; font-weight: bold">set</span> <span style="color: #996633">this_item</span> <span style="color: #008800; font-weight: bold">to</span> <span style="color: #007020">item</span> <span style="color: #996633">i</span> <span style="color: #008800; font-weight: bold">of</span> <span style="color: #996633">downList</span>
				<span style="color: #888888">-- insert actions here</span>
				<span style="color: #008800; font-weight: bold">set</span> <span style="color: #996633">newItem</span> <span style="color: #008800; font-weight: bold">to</span> {<span style="color: #996633">url</span>:<span style="color: #996633">this_item</span>}
				<span style="color: #007020">copy</span> <span style="color: #996633">newItem</span> <span style="color: #008800; font-weight: bold">to</span> <span style="color: #007020">the</span> <span style="color: #008800; font-weight: bold">end</span> <span style="color: #008800; font-weight: bold">of</span> <span style="color: #996633">newDownList</span>
			<span style="color: #008800; font-weight: bold">end</span> <span style="color: #008800; font-weight: bold">repeat</span>
			<span style="color: #996633">DownloadURL</span> <span style="color: #996633">newDownList</span>
		<span style="color: #008800; font-weight: bold">end</span> <span style="color: #008800; font-weight: bold">tell</span>
	<span style="color: #008800; font-weight: bold">end</span> <span style="color: #008800; font-weight: bold">if</span>
<span style="color: #008800; font-weight: bold">end</span> <span style="color: #008800; font-weight: bold">tell</span>
</pre></div>

			</div>

			
		</div>

  </body>
</html>
